<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cellox: backend/garbage_collector.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="file_type_cellox.png"/></td>
  <td id="projectalign">
   <div id="projectname">Cellox<span id="projectnumber">&#160;0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('garbage__collector_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">garbage_collector.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>File containing implementation of functionality used for garbage collection.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="garbage__collector_8h_source.html">garbage_collector.h</a>&quot;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &quot;<a class="el" href="compiler_8h_source.html">../frontend/compiler.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="memory__mutator_8h_source.html">memory_mutator.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="object_8h_source.html">../language-models/object.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="virtual__machine_8h_source.html">virtual_machine.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:acdfe815e99fcc24784302a803ed9fac9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="garbage__collector_8c.html#acdfe815e99fcc24784302a803ed9fac9">GC_HEAP_GROWTH_FACTOR</a>&#160;&#160;&#160;(2)</td></tr>
<tr class="separator:acdfe815e99fcc24784302a803ed9fac9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a014e054b75db36a783e439d9e8522b2f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="garbage__collector_8c.html#a014e054b75db36a783e439d9e8522b2f">garbage_collector_blacken_object</a> (<a class="el" href="structobject__t.html">object_t</a> *object)</td></tr>
<tr class="memdesc:a014e054b75db36a783e439d9e8522b2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Blackens an object.  <a href="garbage__collector_8c.html#a014e054b75db36a783e439d9e8522b2f">More...</a><br /></td></tr>
<tr class="separator:a014e054b75db36a783e439d9e8522b2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a4a33ae1986bd19ca99a91f3d97a2f2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="garbage__collector_8c.html#a8a4a33ae1986bd19ca99a91f3d97a2f2">garbage_collector_mark_array</a> (<a class="el" href="structdynamic__value__array__t.html">dynamic_value_array_t</a> *array)</td></tr>
<tr class="memdesc:a8a4a33ae1986bd19ca99a91f3d97a2f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks all the values in an array.  <a href="garbage__collector_8c.html#a8a4a33ae1986bd19ca99a91f3d97a2f2">More...</a><br /></td></tr>
<tr class="separator:a8a4a33ae1986bd19ca99a91f3d97a2f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcf092903d30386d182338c37fb3cba7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="garbage__collector_8c.html#adcf092903d30386d182338c37fb3cba7">garbage_collector_mark_roots</a> ()</td></tr>
<tr class="memdesc:adcf092903d30386d182338c37fb3cba7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks the roots of the compiler.  <a href="garbage__collector_8c.html#adcf092903d30386d182338c37fb3cba7">More...</a><br /></td></tr>
<tr class="separator:adcf092903d30386d182338c37fb3cba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80f2f0d2f0c31895b0edd82e1d0b0ab9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="garbage__collector_8c.html#a80f2f0d2f0c31895b0edd82e1d0b0ab9">garbage_collector_sweep</a> ()</td></tr>
<tr class="memdesc:a80f2f0d2f0c31895b0edd82e1d0b0ab9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Walks through the linked list of objects on the heap and checks their mark bits.  <a href="garbage__collector_8c.html#a80f2f0d2f0c31895b0edd82e1d0b0ab9">More...</a><br /></td></tr>
<tr class="separator:a80f2f0d2f0c31895b0edd82e1d0b0ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c3d56c34992c1f2e4b0e706060d4b2f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="garbage__collector_8c.html#a4c3d56c34992c1f2e4b0e706060d4b2f">garbage_collector_trace_references</a> ()</td></tr>
<tr class="memdesc:a4c3d56c34992c1f2e4b0e706060d4b2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Traces all the references to the objects of the virtual machine that are reachable All the objects that are reachable are marked as gray after the compiler roots are marked.  <a href="garbage__collector_8c.html#a4c3d56c34992c1f2e4b0e706060d4b2f">More...</a><br /></td></tr>
<tr class="separator:a4c3d56c34992c1f2e4b0e706060d4b2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3203724569f48fb8cc011f995d375892"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="garbage__collector_8c.html#a3203724569f48fb8cc011f995d375892">garbage_collector_collect_garbage</a> ()</td></tr>
<tr class="memdesc:a3203724569f48fb8cc011f995d375892"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts the garbage collection process.  <a href="garbage__collector_8c.html#a3203724569f48fb8cc011f995d375892">More...</a><br /></td></tr>
<tr class="separator:a3203724569f48fb8cc011f995d375892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f08f0ec3e7f1343526535f9868d5fe2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="garbage__collector_8c.html#a6f08f0ec3e7f1343526535f9868d5fe2">garbage_collector_mark_object</a> (<a class="el" href="structobject__t.html">object_t</a> *object)</td></tr>
<tr class="memdesc:a6f08f0ec3e7f1343526535f9868d5fe2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks a cellox object.  <a href="garbage__collector_8c.html#a6f08f0ec3e7f1343526535f9868d5fe2">More...</a><br /></td></tr>
<tr class="separator:a6f08f0ec3e7f1343526535f9868d5fe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f5fedd825262e07980e56fe5a41b6b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="garbage__collector_8c.html#a2f5fedd825262e07980e56fe5a41b6b4">garbage_collector_mark_value</a> (<a class="el" href="structvalue__t.html">value_t</a> value)</td></tr>
<tr class="memdesc:a2f5fedd825262e07980e56fe5a41b6b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks a cellox value.  <a href="garbage__collector_8c.html#a2f5fedd825262e07980e56fe5a41b6b4">More...</a><br /></td></tr>
<tr class="separator:a2f5fedd825262e07980e56fe5a41b6b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >File containing implementation of functionality used for garbage collection. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="acdfe815e99fcc24784302a803ed9fac9" name="acdfe815e99fcc24784302a803ed9fac9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdfe815e99fcc24784302a803ed9fac9">&#9670;&#160;</a></span>GC_HEAP_GROWTH_FACTOR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GC_HEAP_GROWTH_FACTOR&#160;&#160;&#160;(2)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a014e054b75db36a783e439d9e8522b2f" name="a014e054b75db36a783e439d9e8522b2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a014e054b75db36a783e439d9e8522b2f">&#9670;&#160;</a></span>garbage_collector_blacken_object()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void garbage_collector_blacken_object </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structobject__t.html">object_t</a> *&#160;</td>
          <td class="paramname"><em>object</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Blackens an object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">object</td><td>The object that is blackened</td></tr>
  </table>
  </dd>
</dl>
<p>This means all the references of this object have been marked </p>

</div>
</div>
<a id="a3203724569f48fb8cc011f995d375892" name="a3203724569f48fb8cc011f995d375892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3203724569f48fb8cc011f995d375892">&#9670;&#160;</a></span>garbage_collector_collect_garbage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void garbage_collector_collect_garbage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Starts the garbage collection process. </p>
<p >The garbage collector of cellox is a precise GC. That means that the garbage collector knows whether words in memory are pointers and which store a value - like a string, boolean or a number. The Algorithm that is used is called mark-and-sweep. It consists of two phases:</p><ol type="1">
<li>Mark phase</li>
<li>Sweep phase <br  />
 In the marking phase we start at the roots and traverse through all the objects the roots refer to. In the sweeping phase all the reachable objects have been marked, and therefore we can reclaim the memory that is used by the unmarked objects. </li>
</ol>

</div>
</div>
<a id="a8a4a33ae1986bd19ca99a91f3d97a2f2" name="a8a4a33ae1986bd19ca99a91f3d97a2f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a4a33ae1986bd19ca99a91f3d97a2f2">&#9670;&#160;</a></span>garbage_collector_mark_array()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void garbage_collector_mark_array </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdynamic__value__array__t.html">dynamic_value_array_t</a> *&#160;</td>
          <td class="paramname"><em>array</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Marks all the values in an array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">array</td><td>The array where all the values are marked </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6f08f0ec3e7f1343526535f9868d5fe2" name="a6f08f0ec3e7f1343526535f9868d5fe2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f08f0ec3e7f1343526535f9868d5fe2">&#9670;&#160;</a></span>garbage_collector_mark_object()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void garbage_collector_mark_object </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structobject__t.html">object_t</a> *&#160;</td>
          <td class="paramname"><em>object</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Marks a cellox object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">object</td><td>The object that is marked </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adcf092903d30386d182338c37fb3cba7" name="adcf092903d30386d182338c37fb3cba7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcf092903d30386d182338c37fb3cba7">&#9670;&#160;</a></span>garbage_collector_mark_roots()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void garbage_collector_mark_roots </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Marks the roots of the compiler. </p>
<p >These are the local variables and temporaries sitting in the VirtualMachine's stack </p>

</div>
</div>
<a id="a2f5fedd825262e07980e56fe5a41b6b4" name="a2f5fedd825262e07980e56fe5a41b6b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f5fedd825262e07980e56fe5a41b6b4">&#9670;&#160;</a></span>garbage_collector_mark_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void garbage_collector_mark_value </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvalue__t.html">value_t</a>&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Marks a cellox value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>The value that is marked </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a80f2f0d2f0c31895b0edd82e1d0b0ab9" name="a80f2f0d2f0c31895b0edd82e1d0b0ab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80f2f0d2f0c31895b0edd82e1d0b0ab9">&#9670;&#160;</a></span>garbage_collector_sweep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void garbage_collector_sweep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Walks through the linked list of objects on the heap and checks their mark bits. </p>
<p >If an object is unmarked, it is unlinked from the list and the memory used by the object is reclaimed </p>

</div>
</div>
<a id="a4c3d56c34992c1f2e4b0e706060d4b2f" name="a4c3d56c34992c1f2e4b0e706060d4b2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c3d56c34992c1f2e4b0e706060d4b2f">&#9670;&#160;</a></span>garbage_collector_trace_references()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void garbage_collector_trace_references </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Traces all the references to the objects of the virtual machine that are reachable All the objects that are reachable are marked as gray after the compiler roots are marked. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_8c739bbef76d64b22d6b0911c526dd76.html">backend</a></li><li class="navelem"><a class="el" href="garbage__collector_8c.html">garbage_collector.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
